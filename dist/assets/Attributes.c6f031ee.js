import{m as D,aV as P,r as f,Z as F,H as M,s as ee,o as i,n as k,u as S,c as h,B as O,ah as j,L,D as te,v as N,w as t,a as e,b as v,h as C,y as A,e as _,F as $,X as R,Y as T,i as ae,J as le,ap as G,l as J,f as d,T as ne,V as W,j as E,g as w,ai as oe,aW as X,d as Y,aU as se}from"./index.e63785cd.js";import{c as Z,m as K}from"./categories.a64c73cd.js";const ue=D({__name:"CategoriesSelect",props:{modelValue:{type:Array},parent:{type:String},level:{type:Number,default:0}},emits:["update:modelValue"],setup(n,{emit:o}){const a=n,l=P(),s=f([]),g=f(!1),x=F(()=>s.value.length===0&&g.value===!1),u=F(()=>s.value.length?a.modelValue[a.level]:null),y=async()=>{g.value=!0;const p={parent:a.parent||""},b=await Z.list(p);s.value=b.data.payload,g.value=!1};y(),M(()=>a.parent,()=>{y();const p=a.modelValue.slice(0,a.level);o("update:modelValue",p)});const m=p=>{let b=[...a.modelValue];p?b[a.level]=p:b=b.slice(0,a.level),o("update:modelValue",b)},V=p=>{o("update:modelValue",p)};return(p,b)=>{const B=ee("CategoriesSelect",!0);return i(),k("div",{class:te({"mt-2":!!n.parent})},[S(x)?L("",!0):(i(),h(j,O({key:0,items:s.value,"item-title":"name","item-value":"_id"},S(l),{loading:g.value,modelValue:S(u),"onUpdate:modelValue":m}),null,16,["items","loading","modelValue"])),S(u)?(i(),h(B,O({key:1,parent:S(u)},S(l),{level:n.level+1,modelValue:n.modelValue,"onUpdate:modelValue":V}),null,16,["parent","level","modelValue"])):L("",!0)],2)}}}),de=D({__name:"MercadolibreAttributesSelect",props:{marketplace:null,category:null},setup(n){const o=n,a=P(),l=f([]),s=async()=>{const g=await K.listCategoryAttributes(o.marketplace._id,o.category);l.value=g.data.payload};return M(()=>o.category,()=>{s()},{immediate:!0}),(g,x)=>(i(),h(j,O({items:l.value,"item-title":"name","item-value":"id"},S(a)),null,16,["items"]))}}),re=D({__name:"MappingSection",props:{category:null},setup(n){const o=f([]);return K.list().then(a=>o.value=a.data.payload),(a,l)=>(i(!0),k($,null,N(o.value,s=>(i(),h(_,null,{default:t(()=>[e(v,null,{default:t(()=>[C(A(s.name)+" ",1),s.type==="mercadolibre"?(i(),h(de,{key:0,marketplace:s,category:n.category,variant:"outlined",density:"compact","hide-details":"",clearable:"",placeholder:"Seleccion un atributo"},null,8,["marketplace","category"])):L("",!0)]),_:2},1024)]),_:2},1024))),256))}});var I=(n=>(n.Select="select",n.Text="text",n.Color="color",n))(I||{}),H={list(n={sort:"nombre",order:"1"}){return R.get(T.DASHBOARD_BASE_URL+"/api/marketplace-attributes",{params:n})},update(n,o){return R.put(T.DASHBOARD_BASE_URL+`/api/marketplace-attributes/${n}`,o)},create(n){return R.post(T.DASHBOARD_BASE_URL+"/api/marketplace-attributes",n)},delete(n,o){return R.delete(T.DASHBOARD_BASE_URL+`/api/marketplace-attributes/${n}`,{data:o})}};const ie={class:"headline"},ce=d("h3",{class:"mt-1"},"Datos generales",-1),me=d("div",{class:"body-1 font-weight-bold"},"Nombre atributo",-1),pe=d("div",{class:"body-1 font-weight-bold"},"Tipo",-1),ve=d("div",{class:"body-1 font-weight-bold"},"Categoria",-1),_e=d("h3",{class:"mt-1"},"Mapeo de Atributos",-1),fe=d("div",{class:"body-1 font-weight-bold"},"T\xE9rminos",-1),ge=d("div",{class:"body-1 font-weight-bold"},"Nombre",-1),ye=d("div",{class:"body-1 font-weight-bold"},"Descripci\xF3n",-1),be=d("thead",null,[d("tr",null,[d("th",null,"Nombre"),d("th",null,"Descripci\xF3n")])],-1),Ve=d("div",{class:"flex-grow-1"},null,-1),he=D({__name:"index",props:{attribute:null},emits:["save"],setup(n,{emit:o}){var p,b,B,q,z;const a=n,l=f({_id:((p=a.attribute)==null?void 0:p._id)||null,name:((b=a.attribute)==null?void 0:b.name)||"",type:((B=a.attribute)==null?void 0:B.type)||null,terms:((q=a.attribute)==null?void 0:q.terms)||[],category:((z=a.attribute)==null?void 0:z.category)||null}),s=f({name:"",description:""}),g=f([{title:"Select",value:I.Select},{title:"Text",value:I.Text},{title:"Color Picker",value:I.Color}]),x=f(!1),u=f([]);l.value.category&&Z.listOne(l.value.category).then(U=>{u.value=U.data.payload.pathFromRoot.map(c=>c._id)});const y=F(()=>a.attribute?"Modificar Atributo":"Agregar Nuevo Atributo");M(u,U=>{U.length&&Object.assign(l.value,{category:u.value.slice(-1)[0]})});const m=()=>{!s.value.name.trim().length||(l.value.terms.push(s.value),s.value={name:"",description:""})},V=async U=>{if(l.value._id){const Q=await H.update(l.value._id,l.value);o("save",Q.data.payload);return}const r=await H.create(l.value);o("save",r.data.payload)};return(U,c)=>(i(),h(Y,null,{default:t(()=>[e(ae,{onSubmit:le(V,["prevent"])},{default:t(()=>[e(G,null,{default:t(()=>[e(J,{color:"primary",class:"mr-1"},{default:t(()=>[C("mdi-update")]),_:1}),d("span",ie,A(S(y)),1)]),_:1}),e(ne),e(W,null,{default:t(()=>[e(_,{dense:"",class:"mb-2"},{default:t(()=>[e(v,{cols:"12",sm:"12",md:"12"},{default:t(()=>[ce]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(v,{cols:"12",sm:"12",md:"12"},{default:t(()=>[me,e(E,{modelValue:l.value.name,"onUpdate:modelValue":c[0]||(c[0]=r=>l.value.name=r),placeholder:"Ingresa el nombre",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[pe,e(j,{items:g.value,modelValue:l.value.type,"onUpdate:modelValue":c[1]||(c[1]=r=>l.value.type=r),rules:[r=>!!r||"El campo es requerido"],variant:"outlined",density:"compact","hide-details":""},null,8,["items","modelValue","rules"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(v,null,{default:t(()=>[ve,e(ue,{modelValue:u.value,"onUpdate:modelValue":c[2]||(c[2]=r=>u.value=r),variant:"outlined",density:"compact","hide-details":"",clearable:"",placeholder:"Selecciona una categor\xEDa"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{dense:"",class:"mb-2"},{default:t(()=>[e(v,{cols:"12",sm:"12",md:"12"},{default:t(()=>[_e]),_:1})]),_:1}),e(re,{category:l.value.category},null,8,["category"]),e(_,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[fe,e(w,{color:"primary",onClick:m},{default:t(()=>[C(" Agregar ")]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(v,null,{default:t(()=>[ge,e(E,{modelValue:s.value.name,"onUpdate:modelValue":c[3]||(c[3]=r=>s.value.name=r),placeholder:"Ingresa el nombre",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(v,null,{default:t(()=>[ye,e(E,{modelValue:s.value.description,"onUpdate:modelValue":c[4]||(c[4]=r=>s.value.description=r),placeholder:"Ingresa el nombre",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(oe,{class:"f"},{default:t(()=>[be,d("tbody",null,[(i(!0),k($,null,N(l.value.terms,r=>(i(),k("tr",{key:r.name},[d("td",null,A(r.name),1),d("td",null,A(r.description),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),e(X,{"rd-actions":""},{default:t(()=>[Ve,e(w,{type:"submit",loading:x.value,variant:"outlined"},{default:t(()=>[C(" Guardar ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1}))}}),Se={class:"float-right"},Ae=D({__name:"Attributes",setup(n){const o=f([]),a=f(null),l=f(!1);H.list().then(u=>{o.value=u.data.payload});const s=u=>{a.value=u,l.value=!0},g=u=>{if(a.value){const m=o.value.findIndex(V=>V._id===u._id);o.value.splice(m,1,u);return}o.value.push(u)},x=u=>{u===!1&&(a.value=null)};return(u,y)=>(i(),h(W,null,{default:t(()=>[e(_,null,{default:t(()=>[e(v,{class:"ml-2"},{default:t(()=>[e(w,{class:"",onClick:y[0]||(y[0]=m=>l.value=!0)},{default:t(()=>[C("Agregar")]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[(i(!0),k($,null,N(o.value,m=>(i(),h(v,{cols:"4"},{default:t(()=>[e(Y,null,{default:t(()=>[e(G,null,{default:t(()=>[C(A(m.name)+" ",1),d("div",Se,[e(w,{variant:"text",size:"small",color:"dark",icon:"",onClick:V=>s(m)},{default:t(()=>[e(J,null,{default:t(()=>[C("mdi-pencil")]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024),e(X,null,{default:t(()=>[(i(!0),k($,null,N(m.terms,V=>(i(),h(w,{variant:"outlined",key:V.name},{default:t(()=>[C(A(V.name),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(se,{modelValue:l.value,"onUpdate:modelValue":[y[1]||(y[1]=m=>l.value=m),x],"max-width":"600px"},{default:t(()=>[e(he,{attribute:a.value,onSave:g},null,8,["attribute"])]),_:1},8,["modelValue"])]),_:1}))}});export{Ae as default};
